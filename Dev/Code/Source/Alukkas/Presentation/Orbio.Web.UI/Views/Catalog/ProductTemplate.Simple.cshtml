@model Orbio.Web.UI.Models.Catalog.ProductDetailModel
@{
    ViewBag.Title = "Product";
    int flag = (System.Configuration.ConfigurationManager.AppSettings["PriceBreakUp"].ToString() != "") ? Convert.ToInt32(System.Configuration.ConfigurationManager.AppSettings["PriceBreakUp"]) : 1;
}
@if (!string.IsNullOrEmpty((string)ViewBag.Errors))
{

    @Html.Hidden("tosterMsg", (string)ViewBag.Errors)
}
@if (!string.IsNullOrEmpty((string)ViewBag.Sucess))
{

    @Html.Hidden("tosterMsgsuccess", (string)ViewBag.Sucess)
}

@if (!string.IsNullOrEmpty((string)TempData["review"]))
{

    @Html.Hidden("tosterMsgsuccess", (string)TempData["review"])
}


<div class="container">

    <ol class="breadcrumb">
        <li><a href="@Url.Action("Index", "Home")">Home</a></li>
        @{
            foreach (var breadCrumb in this.Model.BreadCrumbs)
            {
                <li><a href="@Url.RouteUrl("Category", new { SeName = breadCrumb.SeName })?p=ct">@breadCrumb.Name</a></li>
            }
        }
        <li class="active"> @this.Model.Name</li>
    </ol>
    <div class="row">

        <div class="col-sm-5">
            <!--<img src="images/Basic_image/zoom.jpg" class="det_img" >-->
            @*<div class="zoom_slide">*@
            @*<a href="@this.Model.DefaultPicture.ImageUrl" title="@this.Model.Name"></a>
                <img src="@this.Model.DefaultPicture.FullSizeImageUrl" class="cloud-zoom" rel="transparentImage: 'data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==', useWrapper: false, showTitle: true, zoomWidth:'300', zoomHeight:'400', adjustY:0, adjustX:10" />*@

            @*<a href="@this.Model.DefaultPicture.FullSizeImageUrl" class="cloud-zoom" rel="transparentImage: 'data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==', useWrapper: false, showTitle: true, zoomWidth:'350', zoomHeight:'400', adjustY:0, adjustX:10">
                    <img src="@this.Model.DefaultPicture.FullSizeImageUrl" title="@this.Model.Name">
                </a>*@


            @*</div>*@

            @*<div class="detail_slider">

                    <div class="zoom-section">
                        <div class="zoom-small-image">
                            <a href='@this.Model.DefaultPicture.FullSizeImageUrl' class='cloud-zoom' id='zoom1' rel="position:'inside',showTitle:false,adjustX:-4,adjustY:-4"><img src="@this.Model.DefaultPicture.FullSizeImageUrl" alt='' title="" width="555" height="350" /></a>
                        </div>
                        <div class="zoom-desc">
                            <h3 style="margin-top:2px"></h3>
                            <p>
                                @if (this.Model.ProductPictures.Count > 0)
                                {
                                    foreach (var pic in this.Model.ProductPictures)
                                    {
                                        <a href='@pic.FullSizeImageUrl' class='cloud-zoom-gallery' title='Red' rel="useZoom: 'zoom1', smallImage: '@pic.FullSizeImageUrl' "><img class="zoom-tiny-image" src="@pic.ImageUrl" alt="Thumbnail 1" width="112" height="82"/></a>
                                    }
                                }
                            </p>

                        </div>
                    </div>

                </div>*@
            <div class="detail_slider">


                <ul id="etalage">
                    <li>
                        <a>
                            <img class="etalage_source_image" src="@this.Model.DefaultPicture.FullSizeImageUrl" title="" />
                        </a>
                    </li>
                    @if (this.Model.ProductPictures.Count > 1)
                    {
                        var count = 0;
                        foreach (var pic in this.Model.ProductPictures)
                        {
                            if (count > 0)
                            {
                                <li>
                                    <img class="etalage_source_image" src="@pic.FullSizeImageUrl" title="" />
                                </li>
                            }
                            count++;
                        }
                    }
                </ul>

            </div>
        </div>



        <div class="col-sm-7">
            @using (Html.BeginForm("product", "catalog", new { Id = this.Model.Id, SeName = this.Model.SeName, cartType = Orbio.Core.Domain.Orders.ShoppingCartType.ShoppingCart }, FormMethod.Post, new { Id = "formProduct" }))
            {
                <div class="row res_det">
                    <div class="col-sm-6">
                        <div class="detail_descrip">

                            <h1>@this.Model.Name</h1>
                            @if (!string.IsNullOrEmpty(this.Model.StockAvailability))
                            {
                                <p>Availablity : <span>@this.Model.StockAvailability</span></p>
                            }

                            @{
                            Html.RenderAction("ProductStar", new { Id = this.Model.Id });
                            var finalPrice = Convert.ToDecimal(this.Model.ProductPrice.Price) - this.Model.DiscountAmount;
                            }
                            <p class="price_rate">@this.Model.CurrencyCode.@finalPrice.ToString("#,##0.00")</p>
                            @if (this.Model.ProductPrice.OldPrice != finalPrice)
                            {
                                <s>@this.Model.CurrencyCode.@this.Model.ProductPrice.OldPrice.ToString("#,##0.00")</s>
                            }

                        </div>
                    </div>
                    <div class="col-sm-6">
                        <ul class="desc_butt">
                            <li><a href='@Url.Action("Review", "Catalog", new {this.Model.Name,this.Model.SeName})'>WRITE A REVIEW</a></li>
                            <li><a href="#"><input type="submit" style="outline:none;width:100%;height:100%; border-style:none;background:none" name="WishList" value="ADD TO WISHLIST" /></a></li>
                            <li><a href='@Url.Action("EmailFriend", "Customer", new { this.Model.Name,this.Model.SeName})'>EMAIL TO FRIEND</a></li>
                        </ul>
                    </div>
                </div>

                {
                    if (this.Model.ProductVariantAttributes != null)
                    {
                        Html.RenderPartial("_productAttribute", this.Model.ProductVariantAttributes);
                    }
                }

                <div class="quan_expect">
                    <div class="row">
                        <div class="col-sm-3">
                            <span>Quantity</span>
                            @*@{
                                    var qtyList = new List<object>();
                                     if (this.Model.AllowedQuantities.Count > 0)
                                    {
                                        foreach (var qty in this.Model.AllowedQuantities)
                                        {
                                            qtyList.Add(new{ Text = qty.ToString(), Value = qty.ToString() });
                                        }
                                    }
                                    else
                                    {
                                        for (var i = this.Model.OrderMinimumQuantity; i <= this.Model.OrderMaximumQuantity; i++)
                                        {
                                             qtyList.Add(new  { Text = i.ToString(), Value = i.ToString() });
                                        }
                                    }
                                     var selectedValue = qtyList.Where(qty => qty == this.Model.SelectedQuantity).FirstOrDefault();
                                     if(selectedValue==null)
                                     {
                                         selectedValue = qtyList.FirstOrDefault();
                                     }
                                     var qtySelectList = new SelectList(qtyList, "Value", "Text", selectedValue );
                                }
                                Quantity @Html.DropDownListFor(m=>m.SelectedQuantity, qtySelectList)*@ @*<select id="product.CustomerEnteredPrice" class="quantity">
                                    @if (this.Model.AllowedQuantities.Count > 0)
                                    {
                                        foreach (var qty in this.Model.AllowedQuantities)
                                        {
                                            <option>@qty</option>
                                        }
                                    }
                                    else
                                    {
                                        for (var i = this.Model.OrderMinimumQuantity; i <= this.Model.OrderMaximumQuantity; i++)
                                        {
                                            <option>@i</option>
                                        }
                                    }
                                </select>*@
                                @if (string.IsNullOrEmpty(Model.SelectedQuantity)) { Model.SelectedQuantity = "1"; }
                                @Html.TextBoxFor(m => m.SelectedQuantity, new { type = "Number", @class = "form-control", min = "1", Style = "width:40px;height: 23px;padding: 0 4px;border-radius: 2px;" })
                                @*<a href="@Url.RouteUrl("ShoppingCart")"><input type="submit" class="Buynow" value="BUY NOW"></a>*@
                                <input type="submit" name="Buy" class="Buynow" value="BUY NOW">
                            </div>
                            <div class="col-sm-9">
                                @if (this.Model.IsShipEnabled)
                                {
                                    @:Excepted Delivered Date:  @this.Model.DeliveredIn @*Tuesday, Nov 25, 2014)*@
                                if (this.Model.IsFreeShipping)
                                {
                                    @: <p><i class="ship_icon"></i>FREE SHIPPING IN INDIA</p>
                                }
                                }
                                <p>Need Help? Call<span>+91 495-2722288</span></p>
                            </div>
                        </div>
                    </div>
                if (flag == 1)
                {
                    if (Model.ComponentDetails.Count > 0)
                    {
                        <div class="price-main">
                            <div class="price-button">View Price break up</div>
                            <div class="Price_break">Price Breakup</div>
                            <table cellpadding="0" cellspacing="0" class="Price_breakup" width="100%" align="center">

                                <tr>
                                    @foreach (var priceBreakUp in Model.ComponentDetails)
                                    {
                                        <td>
                                            @priceBreakUp.Key
                                            <p>@this.Model.CurrencyCode.@priceBreakUp.Value</p>
                                        </td>

                                        @*<td>
                                                Other St.
                                                <p>@this.Model.CurrencyCode.@this.Model.Stones</p>
                                            </td>

                                            <td>
                                                Making
                                                <p>@this.Model.CurrencyCode.@this.Model.Making</p>
                                            </td>*@


                                    }
                                    @*<td>
                                            Tax
                                            <p>@this.Model.CurrencyCode.@this.Model.ProductPrice.TaxAmount</p>
                                        </td>*@
                                </tr>
                                @*<tr>
                                        <td>
                                            GOLD
                                            <p>@this.Model.CurrencyCode.@this.Model.Gold</p>
                                        </td>

                                        <td>
                                            Other St.
                                            <p>@this.Model.CurrencyCode.@this.Model.Stones</p>
                                        </td>

                                        <td>
                                            Making
                                            <p>@this.Model.CurrencyCode.@this.Model.Making</p>
                                        </td>

                                        <td>
                                            Tax
                                            <p>Rs.0.00</p>
                                        </td>
                                    </tr>*@
                            </table>
                        </div>
                    }
                }
                <div class="certification">
                    <ul class="clearfix">
                        <li><img src="images/bis.png"></li>
                        <li><img src="images/certified.png"></li>
                        <li><img src="images/return.png"></li>

                    </ul><div class="clear"></div>
                </div>
            }
        </div>

    </div>
</div>

<section class="technical_spec">
    <div class="container">
        <div class="row">
            <div class="col-md-7">

                <div class="panel-group" id="accordion">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">SPECIFICATION <i class="plus_icon"></i></a>
                            </h4>
                        </div>
                        @if (this.Model.SpecificationAttributes != null)
                        {
                            <div id="collapseOne" class="panel-collapse collapse in">
                                <div class="panel-body">

                                    @{
                            Html.RenderPartial("ProductSpecification", this.Model.SpecificationAttributes);
                                    }

                                </div>
                            </div>
                        }
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" class="collapsed">
                                    DESCRIPTION
                                    <i class="plus_icon"></i>
                                </a>
                            </h4>
                        </div>
                        <div id="collapseTwo" class="panel-collapse collapse">
                            <div class="panel-body">

                                @Html.Raw(this.Model.FullDescription)


                            </div>
                        </div>
                    </div>

                </div>

            </div>


            @Html.Action("RelatedProducts", "Catalog", new { productId = this.Model.Id })

        </div>
    </div>


</section>



@*<script src="http://code.jquery.com/jquery-1.6.2.min.js"></script>
    <<<<<<< HEAD
    <script type="text/javascript">
        $('ul.size_li li a').click(
    function (e) {
        //e.preventDefault();
        //e.stopPropagation;
        $(this).closest('ul').find('.select').removeClass('select');
        $(this).parent().addClass('select');
    });
    </script>*@

@if (ViewData["productvariantid"] != null)
{
    <script>
        $('#@ViewData["productvariantid"].ToString()').addClass('select');
    </script>
}

    @*<script type="text/javascript">
            $('ul.size_li li a').click(
        function (e) {
            //e.preventDefault();
            //e.stopPropagation;
            $(this).closest('ul').find('.select').removeClass('select');
            $(this).parent().addClass('select');
        });
        </script>*@
    <script src="~/Scripts/jqueryzoom.js"></script>
    <script>
        jQuery(document).ready(function ($) {

            $('#etalage').etalage({
                thumb_image_width: 515,
                thumb_image_height: 400,
                source_image_width: 900,
                source_image_height: 1200,
                show_hint: true,
                click_callback: function (image_anchor, instance_id) {
                    alert('Callback example:\nYou clicked on an image with the anchor: "' + image_anchor + '"\n(in Etalage instance: "' + instance_id + '")');
                }
            });



            $('.dropdownlist').change(function () {
                etalage_show($(this).find('option:selected').attr('class'));
            });

        });
    </script>

    <script type="text/javascript">
        var $j = jQuery.noConflict();
        $j(document).ready(function () {
            $j('.price-button').click(function () {
                $j('.Price_breakup').toggle();
            });
        });
    </script>