@model Orbio.Web.UI.Areas.Admin.Models.Orders.OrderModel
<script src="~/Areas/Admin/Scripts/jquery.js"></script>
@{
    var count = 1;
}
<div class="col-md-9 main_order_table">
    <table class="item_admin_order">
        <thead>
        <td>Item Description</td>
        <td>Quantity</td>
        <td>Item Price</td>
        <td>Discounted Rate</td>
        <td>Total</td>
        @if (Model.OrderStatus != "Complete" || Model.PaymentStatus!="Paid" || Model.ShippingStatus!="Delivered")
        {
        <td>Action</td>
        }
        </thead>
        <tbody>
        @foreach (var item in Model.Items)
            {
                <script type="text/javascript">
                    $(document).ready(function () {
                        toggleOrderItemEdit@(item.ProductId)(false);
                    });
                </script>

                <script type="text/javascript">
    function toggleOrderItemEdit@(item.ProductId)(editMode) {
        if (editMode) {
            $('#pvQuantity@(item.ProductId)').removeAttr("disabled");

            $('#btnDeleteOrderItem@(item.ProductId)').hide();
            $('#btnEditOrderItem@(item.ProductId)').hide();
            $('#btnSaveOrderItem@(item.ProductId)').show();
            $('#btnCancelOrderItem@(item.ProductId)').show();
            $('#giftcheck@(item.ProductId)').show();
        }
        else {
            $('#pvQuantity@(item.ProductId)').attr("disabled", "disabled");
            $('#btnDeleteOrderItem@(item.ProductId)').show();
            $('#btnEditOrderItem@(item.ProductId)').show();
            $('#btnSaveOrderItem@(item.ProductId)').hide();
            $('#btnCancelOrderItem@(item.ProductId)').hide();
            $('#giftcheck@(item.ProductId)').hide();
        }
    }
                </script>
    
                if (count == 1)
                {
        using (Html.BeginForm("EditOrderItem", "Order", new { id = this.Model.Id }, FormMethod.Post, new { Id = "formEditOrderItem"+item.ProductId }))
            {
                   @:<tr class="first_row">
                   @:<td class="varient_align">
                   @:<img src="@item.ImageUrl" alt="ring" width="58" height="53">
                    <label style="vertical-align: top;">
                        <label class="diamond">@item.ProductName </label><br />
                        <label class="varient">@(new HtmlString(item.AttributeInfo))</label>
                        @if (item.IsGift)
                        {
                        <img src="~/Areas/Admin/images/gift.png" alt="ring" style="border:none;">
                        <input type="checkbox" name="giftcheck@(item.ProductId)" id="giftcheck@(item.ProductId)" checked="@item.IsGift" value="@item.IsGift" style="display:none;" />
                        }
                    </label>
                   @:</td>
                   @:<td class="quantity" style="padding-top: 22px;"><input name="pvQuantity@(item.ProductId)" type="number" value="@item.Quantity" id="pvQuantity@(item.ProductId)" class="adminInput" style="width: 40px;height: 23px;padding: 0 4px;border-radius: 2px;border: 1px solid #ccc;" /></td>
                   @:<td class="number" style="padding-top: 22px;">@item.UnitPriceExclTaxValue.ToString("#,##0.00")</td><td class="number" style="padding-top: 22px;">@item.DiscountExclTaxValue.ToString("#,##0.00")</td>
                   @: <td class="number" style="padding-top: 22px;">@item.SubTotalExclTaxValue.ToString("#,##0.00")</td>
                   if (Model.OrderStatus != "Complete" || Model.PaymentStatus!="Paid" || Model.ShippingStatus!="Delivered")
                   {
                   @: <td class="action_ring">
                   @:<input type="submit" name="btnSaveOrderItem@(item.ProductId)" value="" id="btnSaveOrderItem@(item.ProductId)" class="edit_save" style="display:none;" onclick=" return confirm('Are You Sure'); " />
                   @:<input type="submit" name="btnCancelOrderItem@(item.ProductId)" value="" onclick="toggleOrderItemEdit@(item.ProductId)    (false);return false; " id="btnCancelOrderItem@(item.ProductId)" class="edit_cancel" style="display:none;" />
                   @: <input type="submit" name="btnEditOrderItem@(item.ProductId)" value="" onclick="toggleOrderItemEdit@(item.ProductId)(true);return false; " id="btnEditOrderItem@(item.ProductId)" class="edit_ring" style="float: left;"/>
                   using (Html.BeginForm("DeleteOrderItem", "Order", new { id = this.Model.Id }, FormMethod.Post, new { Id = "formDeleteOrderItem" }))
                    {
                        @: <input type="submit" name="btnDeleteOrderItem@(item.ProductId)" value="" id="btnDeleteOrderItem@(item.ProductId)" class="delete_ring" onclick=" return confirm('Are You Sure'); " />
                    }
                   @:</td>
                }
                   @:</tr>
            }
                   count++;
               }
              else
                  {
                using (Html.BeginForm("EditOrderItem", "Order", new { id = this.Model.Id }, FormMethod.Post, new { Id = "formEditOrderItem" + item.ProductId }))
                 {
                    @:<tr class="second_row">
                    <td class="varient_align">
                    <img src="@item.ImageUrl" alt="ring" width="58" height="53">
                    <label style="vertical-align: top;"><label class="diamond">@item.ProductName </label><br/>
                     <label class="varient">@(new HtmlString(item.AttributeInfo))</label>
                        @if (item.IsGift)
                        {
                            <img src="~/Areas/Admin/images/gift.png" alt="ring" style="border:none;">
                            @:<input type="checkbox" id="giftcheck@(item.ProductId)" checked="@item.IsGift" value="@item.IsGift" style="display:none;" />
                        }</label>
                    </td>
            <td class="quantity" style="padding-top: 22px;"><input name="pvQuantity@(item.ProductId)" type="number" value="@item.Quantity" id="pvQuantity@(item.ProductId)" class="adminInput" style="width: 40px;height: 23px;padding: 0 4px;border-radius: 2px;border: 1px solid #ccc;" /></td><td class="number" style="padding-top: 22px;">@item.UnitPriceExclTaxValue.ToString("#,##0.00")</td><td class="number" style="padding-top: 22px;">@item.DiscountExclTaxValue.ToString("#,##0.00")</td><td class="number" style="padding-top: 22px;">@item.SubTotalExclTaxValue.ToString("#,##0.00")</td>
                   if (Model.OrderStatus != "Complete" || Model.PaymentStatus!="Paid" || Model.ShippingStatus!="Delivered")
                   {
                    @:<td class="action_ring">
                    @:<input type="submit" name="btnSaveOrderItem@(item.ProductId)" value="" id="btnSaveOrderItem@(item.ProductId)" class="edit_save" style="display:none;" onclick=" return confirm('Are You Sure'); " />
                    @:<input type="submit" name="btnCancelOrderItem@(item.ProductId)" value="" onclick="toggleOrderItemEdit@(item.ProductId)    (false);return false; " id="btnCancelOrderItem@(item.ProductId)" class="edit_cancel" style="display:none;" />
                    @: <input type="submit" name="btnEditOrderItem@(item.ProductId)" value="" onclick="toggleOrderItemEdit@(item.ProductId)(true);return false; " id="btnEditOrderItem@(item.ProductId)" class="edit_ring" style="float: left;" />
                       
                    using (Html.BeginForm("DeleteOrderItem", "Order", new { id = this.Model.Id }, FormMethod.Post, new { Id = "formDeleteOrderItem" }))
                        {
                            @: <input type="submit" name="btnDeleteOrderItem@(item.ProductId)" value="" id="btnDeleteOrderItem@(item.ProductId)" class="delete_ring" onclick=" return confirm('Are You Sure'); " />
                        }
                    @:</td>
                    }
                    @:</tr>
                }
                      count = 1;
                  }
            }     
    

        </tbody>
    </table>
</div>
