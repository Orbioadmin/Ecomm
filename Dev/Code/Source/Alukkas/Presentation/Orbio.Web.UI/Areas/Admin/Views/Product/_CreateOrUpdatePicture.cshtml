@model Orbio.Web.UI.Areas.Admin.Models.Product.ProductModel
@{
    ViewBag.Title = "_CreateOrUpdatePicture";
    Layout = null;
    var count = 1;

}


<div class="col-md-12" style=" margin-bottom: 34px;background-color: #fff;margin-top: 10px;width:100%">
    <div class="col-md-9 main_order_table" style="width: 40%;margin-left: 8%;">
        <div id="catprod">
            <table class="item_admin_order" id="tableData">
                <thead>
                <td>Picture</td>
                <td></td>
                </thead>
                <tbody id="trData">
                    @foreach (var item in this.Model.Pictures)
                    {
                        var baseImageUrl = System.Configuration.ConfigurationManager.AppSettings["ImageServerBaseUrl"];
                        var imageUrl = baseImageUrl + item.Picture.RelativeUrl;
                        if (count == 1)
                        {
                            @:<tr class="first_row rowItems" id="@item.Id">
                            count++;
                        }
                        else
                        {
                            @:<tr class="second_row rowItems" id="@item.Id">
                            count = 1;
                        }
                        <td class="align_center" style="cursor: move;"><img src="@imageUrl" alt="ring" width="100" height="80" /></td>
                        <td class="align_center" style="text-align:left;padding-top:28px;width:10px"><a href="@Url.Action("DeleteProductPicture", "Product", new { id = item.Id,productId = item.ProductId })"><input type="button" name="btnDeleteOrderItem@(item.Id)" value="" id="btnDeleteOrderItem@(item.Id)" class="delete_ring" onclick=" return confirm('Are You Sure'); " /></a></td>
                        @:</tr>
                }
                </tbody>
            </table>
        </div>
    <div class="row">
        <div class="col-md-9" style="padding-top: 10px;">
            <span>Note: Please drag and drop the picture for changing display order</span>
        </div>
        <div class="col-md-3" style="padding: 10px;float:right">
            <button class="add_product_submit">Save</button>
        </div>
    </div>
    </div>
    <div class="col-md-3 add_new_projects" style="width:40%">
        <div class="col-md-12">
            <h3>Upload New Picture</h3>
            <table class="product_add_cart uploadFile">
                @Html.Action("PictureUpload", "Picture")
                <tr>
                    <td style="float:left;position:relative;left:65px">
                        <input type="submit" value="Upload" id="UploadProductImage" name="UploadProductImage" class="add_product_submit" />
                    </td>
                    <td id="removeImage" style="float:left;position: relative;left: 104px;">
                        <input type="button" value="Cancel" id="RemoveImage" name="RemoveImage" class="add_product_submit" disabled="disabled" />
                    </td>
                </tr>
            </table>
        </div>
        @Html.HiddenFor(m => m.PictureModel.PictureId)
        @Html.HiddenFor(m => m.Id)
    </div>
    </div>

<script>
    $(function () {
        $('#trData').sortable();
        $('button').on('click', function(){
            var ids = [];
            $('.rowItems').each(function (index, value) {
                var id = $(value).prop('id');
                ids.push(id);
            });
            $.post('@(Url.Action("UpdatePicture", "Product"))',
                { Ids: JSON.stringify(ids) },
                function (response) {

                }
            );
        })
    });
</script>

